<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영화 예매</title>
    <link rel="stylesheet" href="css/reservation.css">
</head>
<body>
<div class="container">
    <h1>영화 예매</h1>

    <!-- 날짜 선택: 일주일 범위 -->
    <div class="date-container">
        <h2>날짜 선택</h2>
        <ul id="date-list">
            <!-- JavaScript로 일주일 날짜를 여기에 추가 -->
        </ul>
    </div>

    <!-- 영화 선택 -->
    <div class="form-group">
        <label for="movie">영화 선택</label>
        <select id="movie" name="movie" required>
            <option value="">영화를 선택해주세요</option>
            <option value="1">인터스텔라</option>
            <option value="2">기생충</option>
        </select>
    </div>

    <!-- 상영관 선택 -->
    <div class="form-group">
        <label for="theater">상영관 선택</label>
        <select id="theater" name="theater" required>
            <option value="">상영관을 선택해주세요</option>
            <option value="A">상영관 A</option>
            <option value="B">상영관 B</option>
        </select>
    </div>

    <!-- 다음 버튼 -->
    <div class="form-group">
        <button type="submit" onclick="alert('다음 페이지로 이동합니다!')">다음</button>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const dateList = document.getElementById("date-list");
        const today = new Date();

        for (let i = 0; i < 7; i++) {
            const currentDate = new Date(today);
            currentDate.setDate(today.getDate() + i);

            // 날짜 포맷 (YYYY-MM-DD)
            const dateString = currentDate.toISOString().split('T')[0];
            const id = `date${i}`; // input의 고유 id 설정

            // 리스트 아이템 생성
            const listItem = document.createElement("li");
            listItem.className = "date-item";
            listItem.innerHTML = `
            <input type="radio" id="${id}" name="selectedDate" value="${dateString}" required>
            <label for="${id}">
                ${currentDate.toLocaleDateString("ko-KR", { weekday: 'short', month: 'long', day: 'numeric' })}
            </label>
        `;
            dateList.appendChild(listItem);
        }
    });

    document.getElementById("movie").addEventListener("change", function() {
        const selectedMovie = this.value;
        const theaterSelect = document.getElementById("theater");

        // 상영관 초기화
        theaterSelect.innerHTML = `<option value="">상영관을 선택해주세요</option>`;

        if (selectedMovie) {
            // 서버로 요청 보내기
            fetch(`/getTheaters?movie=${selectedMovie}`)
                .then(response => response.json())
                .then(data => {
                    data.theaters.forEach(theater => {
                        console.log(theater);
                        const option = document.createElement("option");
                        option.textContent = theater;
                        theaterSelect.appendChild(option);
                    });
                })
                .catch(error => console.error('Error fetching theaters:', error));
        }
    });



</script>
</body>
</html>
